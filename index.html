<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="utf-8">
    <title>Sirius Javascript Simulator</title>
    <style>
        th {
            text-align: left;
        }
    </style>
    <script type="text/javascript" src="./js/config.js"></script>
    <script type="text/javascript" src="./js/initial-balancing.js"></script>
    <script type="text/javascript" src="./js/event-listeners.js"></script>
    <script type="text/javascript" src="./js/simulator-functions.js"></script>
    
</head>
<body>
    <script type="text/javascript">
        
        let tempIdKey;
        let tempToken;
        let newUserCreated;
        let token;
        let initialBalancingCreated;
        let latestBalancingRetrieved;
        let latestInventoryRetrieved;
        let settlementCreated;
        let buildingsCreated = new Array();
        let productionCollected = new Array();
    
        let buildingBarracksTimerInterval;
        let buildingFarmTimerInterval;
        let buildingGoldMineTimerInterval;
        let buildingLumberMillTimerInterval;
        let buildingIronMineTimerInterval;

        let barracksBuildTime;
        let farmBuildTime;
        let goldMineBuiltTime;
        let lumberMillBuildTime;
        let ironMineBuildTime;

        let barracksBuildingIdForCollection;
        let farmBuildingIdForCollection;
        let goldMineBuildingIdForCollection;
        let lumberMillBuildingIdForCollection;
        let ironMineBuildingIdForCollection;

        document.addEventListener('DOMContentLoaded', (event) => {
            console.log('DOMContentLoaded event triggered');
            
            init();
            
        });

        const init = () => {
            console.log('init() called');
            intialState();
        }

        const intialState = () => {
            console.log('intialState() called');
            disableLoginButtons();
            hideBuildBuildingsControls();
            hideProductionControls();
            hideInventoryControls();
        }

        const postLoginState = () => {
            console.log('postLoginState() called');
            retrieveLatestBalancing();
            retrieveUserInventory();
            hideRegistrationControl();
            hideLoginControls();
            buildSettlement();
        }

        const hideRegistrationControl = () => {
            console.log('hideRegistrationControl() called');
            document.getElementById('register-button').style.visibility = 'hidden';
        }
        const hideLoginControls = () => {
            console.log('hideLoginControlrs() called');
            document.getElementById('login-button').style.visibility = 'hidden';
        }

        const disableRegistrationButton = () => {
            console.log('disableRegistrationButton() called');
            document.getElementById('register-button').disabled = true;
        }

        const disableLoginButtons = () => {
            console.log('disableLoginButtons() called');
            document.getElementById('login-button').disabled = true;
        }

        const enableLoginButtons = () => {
            console.log('enableLoginButtons() called');
            document.getElementById('login-button').disabled = false;
        }

        const hideProductionControls = () => {
            console.log('hideProductionControls() called');
            document.getElementById('production-buttons-row').style.visibility  = 'hidden';
        }

        const showProductionControls = () => {
            console.log('showProductionControls() called');
            document.getElementById('production-buttons-row').style.visibility  = 'visible';
        }

        const disableProductionButtons = () => {
            console.log('disableProductionButtons() called');
            document.getElementById('produce-barracks-button').disabled = true;
            document.getElementById('produce-farm-button').disabled = true;
            document.getElementById('produce-gold-mine-button').disabled = true;
            document.getElementById('produce-lumber-mill-button').disabled = true;
            document.getElementById('produce-iron-mine-button').disabled = true;
        }

        const hideInventoryControls = () => {
            console.log('hideInventoryControls() called');
            document.getElementById('inventory-info').style.visibility  = 'hidden';
            document.getElementById('inventory-soldiers').style.visibility  = 'hidden';
            document.getElementById('inventory-food').style.visibility  = 'hidden';
            document.getElementById('inventory-gold').style.visibility  = 'hidden';
            document.getElementById('inventory-lumber').style.visibility  = 'hidden';
            document.getElementById('inventory-iron').style.visibility  = 'hidden';
        }

        const showInventoryControls = () => {
            console.log('showInventoryControls() called');
            document.getElementById('inventory-info').style.visibility  = 'visible';
            document.getElementById('inventory-soldiers').style.visibility  = 'visible';
            document.getElementById('inventory-food').style.visibility  = 'visible';
            document.getElementById('inventory-gold').style.visibility  = 'visible';
            document.getElementById('inventory-lumber').style.visibility  = 'visible';
            document.getElementById('inventory-iron').style.visibility  = 'visible';
        }

        //hides the build buildings controls - buttons, timers, status
        const hideBuildBuildingsControls = () => {
            console.log('hideBuildBuildingsControls() called');
            document.getElementById('build-barracks-row-1').style.visibility  = 'hidden';
            document.getElementById('build-farm-row-1').style.visibility  = 'hidden';
            document.getElementById('build-farm-row-2').style.visibility  = 'hidden';
            document.getElementById('build-farm-row-3').style.visibility  = 'hidden';
            document.getElementById('build-gold-mine-row-1').style.visibility  = 'hidden';
            document.getElementById('build-gold-mine-row-2').style.visibility  = 'hidden';
            document.getElementById('build-gold-mine-row-3').style.visibility  = 'hidden';
            document.getElementById('build-lumber-mill-row-1').style.visibility  = 'hidden';
            document.getElementById('build-lumber-mill-row-2').style.visibility  = 'hidden';
            document.getElementById('build-lumber-mill-row-3').style.visibility  = 'hidden';
            document.getElementById('build-iron-mine-row-1').style.visibility  = 'hidden';
            document.getElementById('build-iron-mine-row-2').style.visibility  = 'hidden';
            document.getElementById('build-iron-mine-row-3').style.visibility  = 'hidden';
        }

        const showBuildBuildingsControls = () => {
            console.log('showBuildBuildingsControls() called');
            document.getElementById('build-barracks-row-1').style.visibility  = 'visible';
            document.getElementById('build-farm-row-1').style.visibility  = 'visible';
            document.getElementById('build-farm-row-2').style.visibility  = 'visible';
            document.getElementById('build-farm-row-3').style.visibility  = 'visible';
            document.getElementById('build-gold-mine-row-1').style.visibility  = 'visible';
            document.getElementById('build-gold-mine-row-2').style.visibility  = 'visible';
            document.getElementById('build-gold-mine-row-3').style.visibility  = 'visible';
            document.getElementById('build-lumber-mill-row-1').style.visibility  = 'visible';
            document.getElementById('build-lumber-mill-row-2').style.visibility  = 'visible';
            document.getElementById('build-lumber-mill-row-3').style.visibility  = 'visible';
            document.getElementById('build-iron-mine-row-1').style.visibility  = 'visible';
            document.getElementById('build-iron-mine-row-2').style.visibility  = 'visible';
            document.getElementById('build-iron-mine-row-3').style.visibility  = 'visible';
        }

        const registerHandler = async () => {
            console.log('registerHandler() called');

            tempIdKey = readTempIdKeyFromConfig();
            tempToken = await login(tempIdKey);
            bearerToken = tempToken.accessToken;

            newUserCreated = await register();
            
            let elem = document.querySelector('#user-info');

            elem.innerHTML = 'New user with username ' +  newUserCreated.username + ' registered';

            disableRegistrationButton();
            enableLoginButtons();
 
        }

        const loginHandler = async () => {
            console.log('loginHandler() called');

            const userForLogin = { 
                "siriusId": newUserCreated.siriusId, 
                "siriusKey": newUserCreated.siriusKey,
                "appId": tempIdKey.appId,
                "appKey": tempIdKey.appKey
                
            };

            token = await login(userForLogin);
            bearerToken = token.accessToken;

            let elem = document.querySelector('#user-info');

            // Get HTML content
            let html = elem.innerHTML;
            
            if (token.accessToken !== null 
                && token.accessToken !== 'undefined' 
                && token.accesToken !== ''){

                elem.innerHTML = 'Welcome user ' +  newUserCreated.username + ' , you are now logged in';

                postLoginState();
            }
        }

        const retrieveLatestBalancing = async () => {
            console.log('retrieveLatestBalancing() called');

            latestBalancingRetrieved = await latestBalancing((balancing)=>{
                          
                console.log('Latest balancing data found')
                console.log(balancing.contents);

                for(i = 0; i < balancing.contents.Building.length; i++ ){
                    
                    if(balancing.contents.Building[i].id === 'barracks'){
                        barracksBuildTime = balancing.contents.Building[i].buildTime;
                    }

                    if(balancing.contents.Building[i].id === 'farm'){
                        farmBuildTime = balancing.contents.Building[i].buildTime;
                    }

                    if(balancing.contents.Building[i].id === 'gold-mine'){
                        goldMineBuiltTime = balancing.contents.Building[i].buildTime;
                    }

                    if(balancing.contents.Building[i].id === 'lumber-mill'){
                        lumberMillBuildTime = balancing.contents.Building[i].buildTime;
                    }

                    if(balancing.contents.Building[i].id === 'iron-mine'){
                        ironMineBuildTime = balancing.contents.Building[i].buildTime;
                    }

                }
                
                //initialize the building controls
                for(i = 0; i < balancing.contents.Building.length; i++){

                    for(j = 0; j < balancing.contents.Building[i].maxQuantity; j++){

                        const timerSelector = '#build-'+balancing.contents.Building[i].id+'-timer-'+(j+1);
                        const statusSelector = '#build-'+balancing.contents.Building[i].id+'-status-'+(j+1);
                        
                        let elem = document.querySelector(timerSelector);
                        elem.value = 'hours:0, minute:0, seconds:'+balancing.contents.Building[i].buildTime;
                        
                        elem = document.querySelector(statusSelector);
                        elem.value = 'Ready to build';
                        
                    }
                }
            });
            
        }

        const retrieveUserInventory = async () => {
            console.log('retrieveUserInventory() called');

            latestInventoryRetrieved = await latestUserInventory(newUserCreated.id, (inventory)=>{
                
                if (inventory.content.length === 0) {
                    console.log('No inventory found for user with id: ' + newUserCreated.id);
                    console.log(inventory);
                } else {

                    console.log('Latest inventory retrieved');
                    console.log(inventory);
                }
            });
            
        }
        
        const updateInventoryControls = async () => {
            console.log('updateInventoryControls() called');
            console.log('Latest inventory retrieved');
            console.log(latestInventoryRetrieved);

            let elem;

            for(i = 0; i < await latestInventoryRetrieved.content.length; i++){
                elem = document.querySelector('#inventory-'+latestInventoryRetrieved.content[i].balancingContentId);
                elem.innerHTML = latestInventoryRetrieved.content[i].balancingContentId + ': ' + latestInventoryRetrieved.content[i].quantity;  

            }
            
        }
        
        const monitorBuildingBarracksStatus = async (buildingId, balancingContentId, buildTime) => {
            console.log('monitorBuildingBarracksStatus(...) called');
            console.log('buildingId: ' + buildingId);
            console.log('balancingContentId: ' + balancingContentId);
            console.log('buildTime: ' + buildTime);

            let activatedBuilding;

            while (true) {
                console.log('monitoring if barracks is activated');
                await sleep(buildTime + '000');
                activatedBuilding = await getBuilding(buildingId);

                if(activatedBuilding.status === 'activated') {
                    buildBarracksActivatedCallback(activatedBuilding);
                    console.log('activated building id: ' + activatedBuilding.id);
                    console.log('activated building balancing content id: ' + activatedBuilding.balancingContentId);
                    console.log('activated building status: ' + activatedBuilding.status);
                    buildingsCreated.push(activatedBuilding);
                    console.log('List of buildings created: ' + JSON.stringify(buildingsCreated));
                    
                    break;
                }
            }
        }

        const monitorBuildingFarmStatus = async (buildingId, balancingContentId, buildTime) => {
            console.log('monitorBuildingFarmStatus(...) called');
            console.log('buildingId: ' + buildingId);
            console.log('balancingContentId: ' + balancingContentId);
            console.log('buildTime: ' + buildTime);

            let activatedBuilding;

            while (true) {
                console.log('monitoring if farm is activated');
                await sleep(buildTime + '000');
                activatedBuilding = await getBuilding(buildingId);

                if(activatedBuilding.status === 'activated') {
                    buildFarmActivatedCallback(activatedBuilding);
                    console.log('activated building id: ' + activatedBuilding.id);
                    console.log('activated building balancing content id: ' + activatedBuilding.balancingContentId);
                    console.log('activated building status: ' + activatedBuilding.status);
                    buildingsCreated.push(activatedBuilding);
                    console.log('List of buildings created: ' + JSON.stringify(buildingsCreated));
                    
                    break;
                }
            }
        }

        const monitorBuildingGoldMineStatus = async (buildingId, balancingContentId, buildTime) => {
            console.log('monitorBuildingGoldMineStatus(...) called');
            console.log('buildingId: ' + buildingId);
            console.log('balancingContentId: ' + balancingContentId);
            console.log('buildTime: ' + buildTime);

            let activatedBuilding;

            while (true) {
                console.log('monitoring if gold-mine is activated');
                await sleep(buildTime + '000');
                activatedBuilding = await getBuilding(buildingId);

                if(activatedBuilding.status === 'activated') {
                    buildGoldMineActivatedCallback(activatedBuilding);
                    console.log('activated building id: ' + activatedBuilding.id);
                    console.log('activated building balancing content id: ' + activatedBuilding.balancingContentId);
                    console.log('activated building status: ' + activatedBuilding.status);
                    buildingsCreated.push(activatedBuilding);
                    console.log('List of buildings created: ' + JSON.stringify(buildingsCreated));
                    
                    break;
                }
            }
        }

        const monitorBuildingLumberMillStatus = async (buildingId, balancingContentId, buildTime) => {
            console.log('monitorBuildingLumberMillStatus(...) called');
            console.log('buildingId: ' + buildingId);
            console.log('balancingContentId: ' + balancingContentId);
            console.log('buildTime: ' + buildTime);

            let activatedBuilding;

            while (true) {
                console.log('monitoring if lumber-mill is activated');
                await sleep(buildTime + '000');
                activatedBuilding = await getBuilding(buildingId);

                if(activatedBuilding.status === 'activated') {
                    buildLumberMillActivatedCallback(activatedBuilding);
                    console.log('activated building id: ' + activatedBuilding.id);
                    console.log('activated building balancing content id: ' + activatedBuilding.balancingContentId);
                    console.log('activated building status: ' + activatedBuilding.status);
                    buildingsCreated.push(activatedBuilding);
                    console.log('List of buildings created: ' + JSON.stringify(buildingsCreated));
                    
                    break;
                }
            }
        }
        
        const monitorBuildingIronMineStatus =  async (buildingId, balancingContentId, buildTime) => {
            console.log('monitorBuildingIronMineStatus(...) called');
            console.log('buildingId: ' + buildingId);
            console.log('balancingContentId: ' + balancingContentId);
            console.log('buildTime: ' + buildTime);

            let activatedBuilding;

            while (true) {
                console.log('monitoring if iron-mine is activated');
                await sleep(buildTime + '000');
                activatedBuilding = await getBuilding(buildingId);

                if(activatedBuilding.status === 'activated') {
                    buildIronMineActivatedCallback(activatedBuilding);
                    console.log('activated building id: ' + activatedBuilding.id);
                    console.log('activated building balancing content id: ' + activatedBuilding.balancingContentId);
                    console.log('activated building status: ' + activatedBuilding.status);
                    buildingsCreated.push(activatedBuilding);
                    console.log('List of buildings created: ' + JSON.stringify(buildingsCreated));
                    
                    break;
                }
            }
        }

        const startProduction = async (balancingContentId, itemId) => {
            console.log('startProduction(..) called');
            console.log('production for ' + balancingContentId + ' triggered');

            //retrieve the necessary function parameters for starting the production
            let buildingId;
            
            for (i = 0; i < buildingsCreated.length; i++) {

                if (buildingsCreated[i].balancingContentId === balancingContentId){
                    buildingId = buildingsCreated[i].id;
                    console.log('retrieving building id: ' + buildingsCreated[i].id);
                    break;
                }

            }

            let production = await createProduction(buildingId, itemId, 'start');
            monitorProductionQuantity(production.id, 1, itemId, balancingContentId); 
            console.log('production is in progress');
            console.log(production)

        }

        const monitorProductionQuantity = async (productionId, secondInterval, produceId, balancingContentId) => {
            
            console.log('monitorProductionQuantity(....) called');

            while(true){

                await sleep(secondInterval + '000')
                
                let monitoredProduction = await retrieveProduction(productionId);

                if (monitoredProduction.meta.quantity !== 0) {
                    document.getElementById('produce-'+balancingContentId+'-button').disabled = false;
                }
                
            }
        }
        
        const collect = async (buildingBuildingId, produceId) => {
            console.log('collect(..) called');
            let collectedProduction = await collectProduction(buildingBuildingId);
            latestInventoryRetrieved = await latestUserInventory(newUserCreated.id);
            
            let elem = document.querySelector('#inventory-'+produceId);
            if(latestInventoryRetrieved.content.length !== 0) {
                elem.innerHTML = produceId + ': ' + latestInventoryRetrieved.content[0].quantity;  
            }
        }

        const buildingBarracksStartTimer = (millisecondTick, buildTime) => {
            console.log('buildingBarracksStartTimer(..) called');
            let seconds = buildTime;
            let minutes = 0; 
            let hours = 0;

            buildingBarracksTimerInterval = setInterval(function () {           
                
                seconds--;

                if (seconds >= 0) {
                    minutes = Math.floor(seconds/60);
                    hours = Math.floor(minutes/60);
                } else {
                    minutes = 0;
                    hours = 0;
                }
                

            let elem = document.querySelector('#build-barracks-timer');
            elem.value = 'hours:'+hours+', minute:'+minutes+', seconds:'+seconds

            }, millisecondTick);
            
        }

        const buildingFarmStartTimer = (millisecondTick, buildTime) => {
            console.log('buildingFarmStartTimer(..) called');
            let seconds = buildTime; 
            let minutes = 0; 
            let hours = 0;

            buildingFarmTimerInterval = setInterval(function () {           
                
                seconds--;

                if (seconds >= 0) {
                    minutes = Math.floor(seconds/60);
                    hours = Math.floor(minutes/60);
                } else {
                    minutes = 0;
                    hours = 0;
                }


            let elem = document.querySelector('#build-farm-timer');
            elem.value = 'hours:'+hours+', minute:'+minutes+', seconds:'+seconds

            }, millisecondTick);
            
        }

        const buildingGoldMineStartTimer = (millisecondTick, buildTime) => {
            console.log('buildingGoldMineStartTimer(..) called');
            let seconds = buildTime; 
            let minutes = 0; 
            let hours = 0;

            buildingGoldMineTimerInterval = setInterval(function () {           
                
                seconds--;

                if (seconds >= 0) {
                    minutes = Math.floor(seconds/60);
                    hours = Math.floor(minutes/60);
                } else {
                    minutes = 0;
                    hours = 0;
                }


            let elem = document.querySelector('#build-gold-mine-timer');
            elem.value = 'hours:'+hours+', minute:'+minutes+', seconds:'+seconds

            }, millisecondTick);
            
        }

        const buildingLumberMillStartTimer = (millisecondTick, buildTime) => {
            console.log('buildingLumberMillStartTimer(..) called');
            let seconds = buildTime; 
            let minutes = 0; 
            let hours = 0;

            buildingLumberMillTimerInterval = setInterval(function () {           
                
                seconds--;

                if (seconds >= 0) {
                    minutes = Math.floor(seconds/60);
                    hours = Math.floor(minutes/60);
                } else {
                    minutes = 0;
                    hours = 0;
                }


            let elem = document.querySelector('#build-lumber-mill-timer');
            elem.value = 'hours:'+hours+', minute:'+minutes+', seconds:'+seconds

            }, millisecondTick);
            
        }

        const buildingIronMineStartTimer = (millisecondTick, buildTime) => {
            console.log('buildingIronMineStartTimer(..) called');
            let seconds = buildTime; 
            let minutes = 0; 
            let hours = 0;

            buildingIronMineTimerInterval = setInterval(function () {           
                
                seconds--;

                if (seconds >= 0) {
                    minutes = Math.floor(seconds/60);
                    hours = Math.floor(minutes/60);
                } else {
                    minutes = 0;
                    hours = 0;
                }


            let elem = document.querySelector('#build-iron-mine-timer');
            elem.value = 'hours:'+hours+', minute:'+minutes+', seconds:'+seconds

            }, millisecondTick);
            
        }

        const buildingBarracksStopTimer = () => {
            console.log('buildingBarracksStopTimer() called');
            clearInterval(buildingBarracksTimerInterval);
        }

        const buildingFarmStopTimer = () =>  {
            console.log('buildingFarmStopTimer() called');
            clearInterval(buildingFarmTimerInterval);
        }

        const buildingGoldMineStopTimer = () => { 
            console.log('buildingGoldMineStopTimer() called');
            clearInterval(buildingGoldMineTimerInterval);
        }

        const buildLumberMillStopTimer = () => {
            console.log('buildLumberMillStopTimer() called');
            clearInterval(buildingLumberMillTimerInterval);
        }

        const buildIronMineStopTimer = () => {
            console.log('buildIronMineStopTimer() called');
            clearInterval(buildingIronMineTimerInterval);
        }

        const buildSettlement = async () => {
            
            console.log('buildSettlement() called');
            
            settlementCreated = await createSettlement((settlement) =>{
                console.log('settlement created');
                console.log(settlement);

                showBuildBuildingsControls();
                //showProductionControls();
                //disableProductionButtons();
                //updateInventoryControls();
                //showInventoryControls();
            });
            
        }

        const buildBarracksHandler = async() =>{
            console.log('buildBarracksHandler() called');
            
            let elem = document.querySelector('#build-barracks-status');
            elem.value = 'Building Barracks...';
            document.getElementById('build-barracks-button').disabled = true;

            buildingBarracksStartTimer(millisecondTickForTimer, barracksBuildTime);
            const newBarracks = await createBuilding(settlementCreated.id, 'barracks');
            monitorBuildingBarracksStatus(newBarracks.id, 'barracks', barracksBuildTime);
            
        }

        const buildFarmHandler = async() =>{
            console.log('buildFarmHandler() called');
            
            let elem = document.querySelector('#build-farm-status');
            elem.value = 'Building Farm...';
            document.getElementById('build-farm-button').disabled = true;

            buildingFarmStartTimer(millisecondTickForTimer, farmBuildTime);
            const newFarm = await createBuilding(settlementCreated.id, 'farm');
            monitorBuildingFarmStatus(newFarm.id, 'farm', farmBuildTime);
            
        }

        const buildGoldMineHandler = async() =>{
            console.log('buildGoldMineHandler() called');
            
            let elem = document.querySelector('#build-gold-mine-status');
            elem.value = 'Building Gold Mine...';
            document.getElementById('build-gold-mine-button').disabled = true;

            buildingGoldMineStartTimer(millisecondTickForTimer, goldMineBuiltTime);
            const newGoldMine = await createBuilding(settlementCreated.id, 'gold-mine');
            monitorBuildingGoldMineStatus(newGoldMine.id, 'gold-mine', goldMineBuiltTime);
            
        }

        const buildLumberMillHandler = async() =>{
            console.log('buildLumberMillHandler() called');
            
            let elem = document.querySelector('#build-lumber-mill-status');
            elem.value = 'Building Lumber Mine...';
            document.getElementById('build-lumber-mill-button').disabled = true;

            buildingLumberMillStartTimer(millisecondTickForTimer, lumberMillBuildTime);
            const newLumberMill = await createBuilding(settlementCreated.id, 'lumber-mill');
            monitorBuildingLumberMillStatus(newLumberMill.id, 'lumber-mill', lumberMillBuildTime);
            
        }

        const buildIronMineHandler = async() =>{
            console.log('buildIronMineHandler() called');
            
            let elem = document.querySelector('#build-iron-mine-status');
            elem.value = 'Building Iron Mine...';
            document.getElementById('build-iron-mine-button').disabled = true;

            buildingIronMineStartTimer(millisecondTickForTimer, ironMineBuildTime);
            const newIronMine = await createBuilding(settlementCreated.id, 'iron-mine');
            monitorBuildingIronMineStatus(newIronMine.id, 'iron-mine', ironMineBuildTime);
            
        }

        const buildBarracksActivatedCallback = async(activatedBarracks)=>{
            console.log('buildBarracksActivatedCallback(.) called');
            buildingBarracksStopTimer();
            
            let elem = document.querySelector('#build-barracks-status');
            elem.value = 'Barracks created';

            document.getElementById('produce-barracks-button').disabled = false;

            console.log('Barracks created');
            console.log(activatedBarracks);

            startProduction('barracks', 'soldier');
            
        }

        const buildFarmActivatedCallback = async(activatedFarm)=>{
            console.log('buildFarmActivatedCallback(.) called');
            buildingFarmStopTimer();
            
            let elem = document.querySelector('#build-farm-status');
            elem.value = 'Farm created';

            document.getElementById('produce-farm-button').disabled = false;

            console.log('Farm created');
            console.log(activatedFarm);

            startProduction('farm', 'food');
            
        }

        const buildGoldMineActivatedCallback = async(activatedGoldMine)=>{
            console.log('buildGoldMineActivatedCallback(.) called');
            buildingGoldMineStopTimer();
            
            let elem = document.querySelector('#build-gold-mine-status');
            elem.value = 'Gold Mine created';

            document.getElementById('produce-gold-mine-button').disabled = false;

            console.log('Gold Mine created');
            console.log(activatedGoldMine);

            startProduction('gold-mine', 'gold');
            
        }

        const buildLumberMillActivatedCallback = async(activatedLumberMill)=>{
            console.log('buildLumberMillActivatedCallback(.) called');
            buildLumberMillStopTimer();
            
            let elem = document.querySelector('#build-lumber-mill-status');
            elem.value = 'Lumber Mill created';

            document.getElementById('produce-lumber-mill-button').disabled = false;

            console.log('Lumber Mill created');
            console.log(activatedLumberMill);
            
            startProduction('lumber-mill', 'lumber');
        }

        const buildIronMineActivatedCallback = async(activatedIronMine)=>{
            console.log('buildIronMineActivatedCallback() called');
            buildIronMineStopTimer();
            
            let elem = document.querySelector('#build-iron-mine-status');
            elem.value = 'Iron Mine created';

            document.getElementById('produce-iron-mine-button').disabled = false;

            console.log('Iron mine created');
            console.log(activatedIronMine);
            
            startProduction('lumber-mill', 'lumber');
        }
        
        
    </script>

<table class=".simulator-ui-container">
    <tr>
      <th id="user-info"></th>
    </tr>
    <tr>
        <td>
            <button id="register-button" type="button" onclick="javascript:registerHandler()">Register</button>
        </td>
    </tr>
    <tr>
        <td>
            <button id="login-button" type="button" onclick="javascript:loginHandler()">Login</button>
        </td>
    </tr>
    <tr id="build-barracks-row-1">
        <td>
            <p>Building Controls</p>
            <button id="build-barracks-button-1" type="button" onclick="javascript:buildBarracksHandler()">Build Barracks</button>
            <label>Timer </label><input id="build-barracks-timer-1" type="text" disabled=true size="31">
            <label>Status </label><input id="build-barracks-status-1" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-farm-row-1">
        <td>
            <button id="build-farm-button-1" type="button" onclick="javascript:buildFarmHandler()">Build Farm</button>
            <label>Timer </label><input id="build-farm-timer-1" type="text" disabled=true size="31">
            <label>Status </label><input id="build-farm-status-1" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-farm-row-2">
        <td>
            <button id="build-farm-button-2" type="button" onclick="javascript:buildFarmHandler()">Build Farm</button>
            <label>Timer </label><input id="build-farm-timer-2" type="text" disabled=true size="31">
            <label>Status </label><input id="build-farm-status-2" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-farm-row-3">
        <td>
            <button id="build-farm-button-3" type="button" onclick="javascript:buildFarmHandler()">Build Farm</button>
            <label>Timer </label><input id="build-farm-timer-3" type="text" disabled=true size="31">
            <label>Status </label><input id="build-farm-status-3" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-gold-mine-row-1">
        <td>
            <button id="build-gold-mine-button-1" type="button" onclick="javascript:buildGoldMineHandler()">Build Gold Mine</button>
            <label>Timer </label><input id="build-gold-mine-timer-1" type="text" disabled=true size="31">
            <label>Status </label><input id="build-gold-mine-status-1" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-gold-mine-row-2">
        <td>
            <button id="build-gold-mine-button-2" type="button" onclick="javascript:buildGoldMineHandler()">Build Gold Mine</button>
            <label>Timer </label><input id="build-gold-mine-timer-2" type="text" disabled=true size="31">
            <label>Status </label><input id="build-gold-mine-status-2" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-gold-mine-row-3">
        <td>
            <button id="build-gold-mine-button-3" type="button" onclick="javascript:buildGoldMineHandler()">Build Gold Mine</button>
            <label>Timer </label><input id="build-gold-mine-timer-3" type="text" disabled=true size="31">
            <label>Status </label><input id="build-gold-mine-status-3" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-lumber-mill-row-1">
        <td>
            <button id="build-lumber-mill-button-1" type="button" onclick="javascript:buildLumberMillHandler()">Build Lumber Mill</button>
            <label>Timer </label><input id="build-lumber-mill-timer-1" type="text" disabled=true size="31">
            <label>Status </label><input id="build-lumber-mill-status-1" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-lumber-mill-row-2">
        <td>
            <button id="build-lumber-mill-button-2" type="button" onclick="javascript:buildLumberMillHandler()">Build Lumber Mill</button>
            <label>Timer </label><input id="build-lumber-mill-timer-2" type="text" disabled=true size="31">
            <label>Status </label><input id="build-lumber-mill-status-2" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-lumber-mill-row-3">
        <td>
            <button id="build-lumber-mill-button-3" type="button" onclick="javascript:buildLumberMillHandler()">Build Lumber Mill</button>
            <label>Timer </label><input id="build-lumber-mill-timer-3" type="text" disabled=true size="31">
            <label>Status </label><input id="build-lumber-mill-status-3" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-iron-mine-row-1">
        <td>
            <button id="build-iron-mine-button-1" type="button" onclick="javascript:buildIronMineHandler()">Build Iron Mine</button>
            <label>Timer </label><input id="build-iron-mine-timer-1" type="text" disabled=true size="31">
            <label>Status </label><input id="build-iron-mine-status-1" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-iron-mine-row-2">
        <td>
            <button id="build-iron-mine-button-2" type="button" onclick="javascript:buildIronMineHandler()">Build Iron Mine</button>
            <label>Timer </label><input id="build-iron-mine-timer-2" type="text" disabled=true size="31">
            <label>Status </label><input id="build-iron-mine-status-2" type="text" disabled=true>
        </td>
    </tr>
    <tr id="build-iron-mine-row-3">
        <td>
            <button id="build-iron-mine-button-3" type="button" onclick="javascript:buildIronMineHandler()">Build Iron Mine</button>
            <label>Timer </label><input id="build-iron-mine-timer-3" type="text" disabled=true size="31">
            <label>Status </label><input id="build-iron-mine-status-3" type="text" disabled=true>
        </td>
    </tr>
    <tr id="production-buttons-row">
        <td>
            <p>Collection</p>
            <button id="produce-barracks-button" type="button" onclick="javascript:collect(barracksBuildingIdForCollection, 'soldiers') ">Collect Soldier</button>
            <button id="produce-farm-button" type="button" onclick="javascript:collect(farmBuildingIdForCollection, 'food') ">Collect Food</button>
            <button id="produce-gold-mine-button" type="button" onclick="javascript:collect(goldMineBuildingIdForCollection, 'gold') ">Collect Gold</button>
            <button id="produce-lumber-mill-button" type="button" onclick="javascript:collect(lumberMillBuildingIdForCollection, 'lumber') ">Collect Lumber</button>
            <button id="produce-iron-mine-button" type="button" onclick="javascript:collect(ironMineBuildingIdForCollection, 'iron') ">Collect Iron</button>
        </td>
    </tr>
  </table>
  <br>
  <br>
  <table>
    <tr>
      <th id="inventory-info">Inventory</th>
    </tr>
    <tr>
        <td id="inventory-soldiers">
            soldier: 0
        </td>
    </tr>
    <tr>
        <td id="inventory-food">
            food: 0
        </td>
    </tr>
    <tr>
        <td id="inventory-gold">
            gold: 0
        </td>
    </tr>
    <tr>
        <td id="inventory-lumber">
            lumber: 0
        </td>
    </tr>
    <tr>
        <td id="inventory-iron">
            iron: 0
        </td>
    </tr>
  </table>
</body>
</html>